<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>TELEBROSS</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var config = {
    type: Phaser.AUTO,
    width: 800,
    height: 600,
    physics: {
        default: 'arcade',
        arcade: {
            gravity: { y: 390 },
            debug: false
        }
    },
    scene: {
        preload: preload,
        create: create,
        update: update
    }
};

var player;
var stars;
var bombs;
var platforms;
var cursors;
var score = 0;
var gameOver = false;
var scoreText;
var music;


var game = new Phaser.Game(config);

function SceneA ()
{
    Phaser.Scene.call(this, { key: 'sceneA' });

    this.faseum;
};

var SceneB;
function SceneB ()
{
    Phaser.Scene.call(this, { key: 'sceneB' });

    this.fasedois;
};


function preload ()
{
    this.load.image('parede', 'assets/parede.png');
    this.load.image('ground', 'assets/plataforma.png');
    this.load.image('bloco', 'assets/bloco.png');
    this.load.image('blocolongo', 'assets/bloco2.png');
    this.load.image('star', 'assets/star.png');
    this.load.image('bomb', 'assets/bomb.png');
    this.load.image('boi', 'assets/boi.png');
    this.load.spritesheet('idle', 'assets/ifiano/idle.png', { frameWidth: 38, frameHeight: 62 });
    this.load.spritesheet('run', 'assets/ifiano/run.png', { frameWidth: 43, frameHeight: 62 });
    this.load.spritesheet('runleft', 'assets/ifiano/runleft.png', { frameWidth: 43, frameHeight: 62 });
    this.load.spritesheet('jump', 'assets/ifiano/jump.png', { frameWidth: 47, frameHeight: 62 });
    this.load.spritesheet('jumpleft', 'assets/ifiano/jumpleft.png', { frameWidth: 47, frameHeight: 62 });
    this.load.spritesheet('dead', 'assets/ifiano/dead.png', { frameWidth: 75, frameHeight: 62 });
    this.load.spritesheet('fullscreen', 'assets/fullscreen.png', { frameWidth: 64, frameHeight: 64 });
    this.load.audio('music', 'assets/music.mp3')

    function GameScene ()
    {
        Phaser.Scene.call(this, { key: 'gameScene', active: true });

        this.player = null;
        this.cursors = null;
        this.score = 0;
        this.scoreText = null;
    };
}

function create ()
{



//parte de movimentação de cameras
    this.cameras.main.setBounds(0, 0, 1200 * 2,600 * 2);
    this.physics.world.setBounds(0, 0, 1600 * 2, 1200 * 2); 
   
    
    //  A simple background for our game
    this.add.image(400, 300, 'parede');
    this.add.image(1200, 300, 'parede');
    

    //  The platforms group contains the ground and the 2 ledges we can jump on
    platforms = this.physics.add.staticGroup();

    //  Here we create the ground.
    //  Scale it to fit the width of the game (the original sprite is 400x32 in size)
    platforms.create(400, 700, 'ground').setScale(2).refreshBody();// chão
    platforms.create(800, 700, 'ground').setScale(2).refreshBody();//chão
    platforms.create(1200, 700, 'ground').setScale(2).refreshBody();//chão
    platforms.create(600, 440, 'bloco').setScale(2).refreshBody();//nivel 1
    platforms.create(350, 310, 'blocolongo').setScale(2).refreshBody();//nivel 2
    

    // The player and its settings
    player = this.physics.add.sprite(100, 450, 'idle');

    //parte do player com cameras
    this.cameras.main.startFollow(player, true, 0.05, 0.05);

    //  Player physics properties. Give the little guy a slight bounce.
   /* player.setBounce(0.2);*/
    player.setCollideWorldBounds(false);

    
    

    //  Our player animations, turning, walking left and walking right.
    this.anims.create({
        key: 'left',
        frames: this.anims.generateFrameNumbers('runleft', { start: 0, end: 15 }),
        frameRate: 15,
        repeat: -1
    });

    this.anims.create({
        key: 'turn',
        frames: this.anims.generateFrameNumbers('idle', { start: 0, end: 15 }),
        frameRate: 20,
         repeat: -1
        
    });

    this.anims.create({
        key: 'right',
        frames: this.anims.generateFrameNumbers('run', { start: 0, end: 15 }),
        frameRate: 20,
        repeat: -1
    });

    this.anims.create({
        key: 'up',
        frames: this.anims.generateFrameNumbers('jump', { start: 0, end: 15 }),
        frameRate: 20,
        repeat: -1
    
    });

    this.anims.create({
        key: 'down',
        frames: this.anims.generateFrameNumbers('idle', { start: 0, end: 15 }),
        frameRate: 20,
        repeat: -1
    });    

    var music = this.sound.add('music');
    music.play();


    //  Input Events
    cursors = this.input.keyboard.createCursorKeys();

    //  Some stars to collect, 12 in total, evenly spaced 70 pixels apart along the x axis
    /*stars = this.physics.add.group({
        key: 'star',
        repeat: 11,
        setXY: { x: 12, y: 0, stepX: 70 }
    });

    stars.children.iterate(function (child) {

        //  Give each star a slightly different bounce
        child.setBounceY(Phaser.Math.FloatBetween(0.4, 0.8));

    });
*/
/*    bombs = this.physics.add.group();
*/
    //  The score
    scoreText = this.add.text(16, 16, 'score: 0', { fontSize: '32px', fill: '#000' });


//fullscreen
/*var button = this.add.image(800-16, 16, 'fullscreen', 0).setOrigin(1, 0).setInteractive();

button.on('pointerup', function () {

if (this.scale.isFullscreen)
{
    button.setFrame(0);

    this.scale.stopFullscreen();
}
else
{
    button.setFrame(1);

    this.scale.startFullscreen();
}

}, this);

this.scoreText.setText('v15');

var FKey = this.input.keyboard.addKey('F');

FKey.on('down', function () {

if (this.scale.isFullscreen)
{
    button.setFrame(0);
    this.scale.stopFullscreen();
}
else
{
    button.setFrame(1);
    this.scale.startFullscreen();
}

}, this);*/

    //  Collide the player and the stars with the platforms
    this.physics.add.collider(player, platforms);
   /*0 this.physics.add.collider(stars, platforms);*/
    /*this.physics.add.collider(bombs, platforms);*/

    //  Checks to see if the player overlaps with any of the stars, if he does call the collectStar function
    /*this.physics.add.overlap(player, stars, collectStar, null, this);

    this.physics.add.collider(player, bombs, hitBomb, null, this);
*/

};


function update ()
{


/*  if (gameOver)
    {
        return;
    }
*/
    if (cursors.left.isDown)
    {
        player.setVelocityX(-160);

        player.anims.play('left', true);
    }
    else if (cursors.right.isDown)
    {
        player.setVelocityX(160);

        player.anims.play('right', true);
    }
    else 
    
   {
        player.setVelocityX(0);

        player.anims.play('turn');
    }

     if (cursors.up.isDown && player.body.touching.down)
    {
        player.setVelocityY(-330);
        /*player.anims.play('up', true);*/
    }
    
    //alteração de cenaA


this.input.once('pointerdown', function () {

    this.scene.transition({
        target: 'sceneB',
        duration: 2000,
        moveBelow: true,
        onUpdate: this.transitionOut,
        data: { x: 400, y: 300 }
    });

}, this);

transitionOut: function progresso (progress)
{
this.face.y = (500 * progress);
}

//cenaB
this.events.on('transitionstart', function (fromScene, duration) {

this.tweens.add({
targets: planet,
scaleX: 1,
scaleY: 1,
duration: duration
});

}, this);

this.events.on('transitioncomplete', function () { console.log('Complete'); });

this.events.on('transitionout', function (toScene, duration) {

this.tweens.add({
targets: planet,
scaleX: 0,
scaleY: 0,
duration: duration
});

}, this);

this.input.once('pointerdown', function (event) {

this.scene.transition({
target: 'sceneA',
duration: 3000
});

}, this);

    
}

/*
function collectStar (player, star)
{
    star.disableBody(true, true);

    //  Add and update the score
    score += 100;
    scoreText.setText('Score: ' + score);

    if (stars.countActive(true) === 0)
    {
        //  A new batch of stars to collect
        stars.children.iterate(function (child) {

            child.enableBody(true, child.x, 0, true, true);

        });
*/
/*
        var x = (player.x < 400) ? Phaser.Math.Between(400, 800) : Phaser.Math.Between(0, 400);

        var bomb = bombs.create(x, 16, 'bomb');
        bomb.setBounce(1);
        bomb.setCollideWorldBounds(true);
        bomb.setVelocity(Phaser.Math.Between(-200, 200), 20);
        bomb.allowGravity = false;

    }
}
*/
/*
function hitBomb (player, bomb)
{
    this.physics.pause();

    player.setTint(0xff0000);

    player.anims.play('dead', true);

    gameOver = true;
}
*/
</script>

</body>
</html>